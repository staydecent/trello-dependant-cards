<html>
<head>
  <script src="https://trello.com/power-ups/power-up.min.js"></script>
  <script src="https://cdn.jsdelivr.net/riot/2.6/riot+compiler.min.js"></script>
  <link rel="stylesheet" href="https://trello.com/power-ups/power-up.css"/>
  <script>
    document.addEventListener('DOMContentLoaded', function(event) {
      t.sizeTo('#page')
    })

    function attachNew () {
      return t.attach({ url: 'https://trello.com/' })
    }
  </script>
</head>
<body>
  <div id="page">
    <card-search></card-search>
  </div>

  <script type="riot/tag">
    <card-search>
      <div each={ items }>
        <h3>{ title }</h3>
      </div>

      var t = TrelloPowerUp.iframe()

      console.log('hey', t)

      // this.items = []

      // t
      //   .cards('id', 'name', 'url')
      //   .then(function cardResults(results) {
      //     this.items = results.filter(notTitle())
      //   })

      this.items = [
        { title: 'Try out some experimental libraries' },
        { title: 'Do we really need vDom?' },
        { title: 'Pick of some local raspber ries' }
      ]

      function notTitle (title) {
        return function (item) {
          return item.title !== title
        }
      }
    </card-search>
  </script>

  <script>
    riot.mount('*')
  </script>

</body>
</html>
